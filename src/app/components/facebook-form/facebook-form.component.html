<form [formGroup]="formGroup" class="form">

    <div class="form-row">
        <mat-form-field class="form-element">
            <mat-label>Platform</mat-label>
            <mat-select formControlName="facebookPlatform">
            <mat-option value="dv360">Display & Video 360</mat-option>
            <mat-option value="facebook" disabled>Facebook</mat-option>
            </mat-select>
            <mat-error *ngIf="(submitted || form['facebookPlatform'].touched) && form['facebookPlatform'].invalid">
            The field is required
            </mat-error>
        </mat-form-field>
        <div class="form-element">
        </div>
    </div>

    <div class="form-row">
        <mat-form-field class="form-element">
            <mat-label>Ad account</mat-label>
            <input type="text" placeholder="Select your ad account" formControlName="facebookAdAccount" aria-label="ad account" matInput [matAutocomplete]="adAccountsAuto">
            <mat-error *ngIf="(submitted || form['facebookAdAccount'].touched) && form['facebookAdAccount'].invalid">
                The field is required
            </mat-error>
            <mat-autocomplete #adAccountsAuto="matAutocomplete" (optionSelected)="$event" [displayWith]="displayFn">
            <mat-option *ngFor="let adAccount of adAccounts$ | async" [value]="adAccount">
                <ng-container *ngIf="adAccount.business">
                    <span>{{ adAccount.business.name }}: </span>
                </ng-container>
                <span>{{ adAccount.name }}</span>
            </mat-option>
            </mat-autocomplete>
        </mat-form-field>

        <mat-form-field class="form-element">
            <mat-label>Advertiser</mat-label>
            <input type="text" placeholder="Select your advertiser" formControlName="dv360Advertiser" aria-label="advertiser" matInput [matAutocomplete]="advertisersAuto">
            <mat-error *ngIf="(submitted || form['dv360Advertiser'].touched) && form['dv360Advertiser'].invalid">
                The field is required
            </mat-error>
            <mat-autocomplete #advertisersAuto="matAutocomplete" (optionSelected)="$event" [displayWith]="displayFn">
            <mat-option *ngFor="let advertiser of advertisers$ | async" [value]="advertiser">
                {{ advertiser.displayName }}
            </mat-option>
            </mat-autocomplete>
        </mat-form-field>
    </div>

    <div class="form-row">
        <mat-form-field class="form-element">
            <mat-label>Campaign Id</mat-label>

            <mat-chip-grid #chipGrid aria-label="Campaign Selection">
            <mat-chip-row *ngFor="let campaign of campaigns" (removed)="remove(campaign)">
                <span>{{ truncateName(campaign, 25) }}</span>
                <button matChipRemove class="mat-chip-remove" [attr.aria-label]="'remove ' + campaign.displayName">
                <mat-icon>cancel</mat-icon>
                </button>
            </mat-chip-row>
            </mat-chip-grid>

            <input placeholder="Select your campaigns" #campaignInput formControlName="dv360CampaignId"
            [matChipInputFor]="chipGrid" [matAutocomplete]="campaignsAuto"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            (matChipInputTokenEnd)="add($event)"/>

            <mat-autocomplete #campaignsAuto="matAutocomplete" (optionSelected)="selected($event)">
            <mat-option *ngFor="let campaign of campaigns$ | async" [value]="campaign">
                <mat-checkbox [checked]="campaign.selected" (click)="$event.stopPropagation(); toggleSelection(campaign)">
                {{ campaign.displayName }} | {{ campaign.campaignId }}
                </mat-checkbox>
            </mat-option>
            </mat-autocomplete>
        </mat-form-field>

        <mat-form-field class="form-element">
            <mat-label>Budget</mat-label>
            <input matInput formControlName="facebookBudget">
            <mat-error *ngIf="form['facebookBudget'].errors?.['required'] && (submitted || form['facebookBudget'].touched)">
                The field is required
            </mat-error>
            <mat-error *ngIf="form['facebookBudget'].errors?.['pattern'] && (submitted || form['facebookBudget'].touched)">
                Please enter a valid number
            </mat-error>
        </mat-form-field>
    </div>

    <div class="form-row">
        <mat-form-field class="form-element">
            <mat-label>Start Date</mat-label>
            <input matInput [matDatepicker]="startPicker" formControlName="facebookStartDate">
            <mat-hint>MM/DD/YYYY</mat-hint>
            <mat-datepicker-toggle matIconSuffix [for]="startPicker"></mat-datepicker-toggle>
            <mat-datepicker #startPicker></mat-datepicker>
            <mat-error *ngIf="form['facebookStartDate'].errors?.['required']">
                This field is required.
            </mat-error>
            <mat-error *ngIf="form['facebookStartDate'].errors?.['invalidDate']">
                Please enter a valid date.
            </mat-error>
        </mat-form-field>

        <mat-form-field class="form-element">
            <mat-label>End Date</mat-label>
            <input matInput [matDatepicker]="endPicker" formControlName="facebookEndDate">
            <mat-hint>MM/DD/YYYY</mat-hint>
            <mat-datepicker-toggle matIconSuffix [for]="endPicker"></mat-datepicker-toggle>
            <mat-datepicker #endPicker></mat-datepicker>
            <mat-error *ngIf="form['facebookEndDate'].errors?.['required']">
                This field is required.
            </mat-error>
            <mat-error *ngIf="form['facebookEndDate'].errors?.['invalidDate']">
                Please enter a valid date.
            </mat-error>
            <mat-error *ngIf="form['facebookEndDate'].errors?.['dateMismatch']">
                End date must be after or equal to start date.
            </mat-error>
        </mat-form-field>
    </div>

</form>